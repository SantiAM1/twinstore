{% load static %}
{% load custom_filters %}
<article class="card-product">
    {% if producto.banner %}
        <span class="card-product-discount {% if producto.evento.esta_activo %}event{% endif %}">{{ producto.banner }}</span>
        {% if producto.evento.esta_activo and producto.evento.logo %}
        <img class="card-product-banner" src="{{ producto.evento.logo.url }}" alt="{{ producto.evento.nombre }}" height="50" width="50">
        {% endif %}
    {% endif %}
    <a href="{% url 'products:slug_dispatcher' producto.slug %}">
        <header class="card-product__media">
            {% if producto.colores.exists %}
            {% for color in producto.get_portada_color_200 %}
                <img src="{{ color.url }}" alt="{{ producto.nombre }}" data-hex="{{ color.hex }}" class="{% if not forloop.first %}hide{% endif %}">
            {% endfor %}
            {% else %}
                <img src="{{producto.get_portada_200}}" alt="{{producto.nombre}}">
            {% endif %}
        </header>
        <p class="card-product__name">{{producto.nombre}}</p>
        <div class="card-product-colors">
        {% if producto.colores.exists %}
            {% for color in producto.colores.all %}
                <button type="button" aria-label="Seleccionar color" class="card-color-dot {% if forloop.first %}selected{% endif %} btn-card" style="background-color: {{ color.hex }};" data-hex="{{color.hex}}" data-colorId="{{color.id|signing_data}}"></button>
            {% endfor %}
        {% endif %}
        </div>
        <footer>
            <div class="card-product__prices">
                <span class="price--current">{{producto.precio_final|formato_pesos}}</span>
                {% if producto.descuento > 0 %}<span class="price--old">{{producto.precio_base|formato_pesos}}</span>{% endif %}
            </div>
            <button class="card-product__cart btn-card" type="button" aria-label="Agregar al carrito" data-productId="{{producto.id|signing_data}}">
                {% if config.modo_stock == 'estricto' %}
                {{ producto.obtener_stock_dict|json_script:"stock-data" }}
                {% endif %}
                <svg  xmlns="http://www.w3.org/2000/svg"  width="30"  height="30"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-shopping-cart">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                    <path d="M6 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
                    <path d="M17 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
                    <path d="M17 17h-11v-14h-2" />
                    <path d="M6 5l14 1l-1 7h-13" />
                </svg>
            </button>
        </footer>
    </a>
</article>